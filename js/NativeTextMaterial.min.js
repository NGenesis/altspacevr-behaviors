"use strict";window.altspaceutil=window.altspaceutil||{},altspaceutil.behaviors=altspaceutil.behaviors||{},altspaceutil.addNativeEventListener=function(e,t){return altspace.inClient&&altspace._internal&&altspace._internal.couiEngine?altspace._internal.couiEngine.on(e,t):null},altspaceutil.removeNativeEventListener=function(e,t){altspace.inClient&&altspace._internal&&altspace._internal.couiEngine&&altspace._internal.couiEngine.off(e,t)},altspaceutil.removeAllNativeEventListeners=function(e){altspace.inClient&&altspace._internal&&altspace._internal.couiEngine&&altspace._internal.couiEngine.events[e]&&delete altspace._internal.couiEngine.events[e]},altspaceutil.getObject3DById=function(e){return altspace.inClient&&altspace._internal?altspace._internal.getObject3DById(e):null},altspaceutil.getThreeJSScene=function(e){return altspace.inClient&&altspace._internal?altspace._internal.getThreeJSScene():null},altspaceutil.getAbsoluteURL=function(e){if(e&&!e.startsWith("http"))if(e.startsWith("/"))e=location.origin+e;else{var t=location.pathname;t.endsWith("/")||(t=location.pathname.split("/").slice(0,-1).join("/")+"/"),e=location.origin+t+e}return e},altspaceutil.getBasePath=function(e){return e.split("/").slice(0,-1).join("/")+"/"},altspaceutil.manageBehavior=function(e,t){e.__isManaged=!0,t.__resetManagedBehavior||t.addEventListener("removed",t.__resetManagedBehavior=function(){t.__resetManagedBehavior&&(t.removeEventListener("removed",t.__resetManagedBehavior),t.__resetManagedBehavior=null),t.traverse(function(e){if(e.__behaviorList)for(var t of e.__behaviorList)if(t.__isInitialized&&t.__isManaged)try{t.dispose&&t.dispose.call(t,e),t.__isInitialized=!1}catch(a){console.group(),(console.error||console.log).call(console,a.stack||a),console.log("[Behavior]"),console.log(t),console.log("[Object3D]"),console.log(e),console.groupEnd()}})})},altspaceutil.unmanageBehavior=function(e,t){e.__isManaged=!1},altspaceutil.cloneWithBehaviors=function(e,t){var a=e.clone(!1);if(e.__behaviorList&&e.__behaviorList.length>0)for(var i of e.__behaviorList)try{if(i.clone){var n=i.clone.call(i,a,e);n&&(a.__behaviorList=a.__behaviorList||[],a.__behaviorList.push(n))}}catch(t){console.group(),(console.error||console.log).call(console,t.stack||t),console.log("[Behavior]"),console.log(i),console.log("[Object3D]"),console.log(e),console.groupEnd()}if(void 0===t||t)for(var o of e.children)a.add(o.cloneWithBehaviors(!0));return a},altspaceutil.behaviors.NativeTextMaterial=function(e){e=e||{},this.type="NativeTextMaterial",this.awake=function(t){this.object3d=t,this.component=this.object3d.getBehaviorByType("n-text"),this.material=e.material||this.object3d.material||new THREE.MeshBasicMaterial({transparent:!0}),this.hasColor=void 0===e.color||e.color,this.hasOpacity=void 0===e.opacity||e.opacity},this.update=function(e){this.removeMaterialTags(),this.component.data.text=this.getMaterialTags()+this.component.data.text},this.dispose=function(){this.removeMaterialTags()},this.removeMaterialTags=function(){var e=this.component.data.text.indexOf('<link id="n-text-material">'),t=e>=0?this.component.data.text.indexOf("</link>",e):-1;e>=0&&t>=0&&(this.component.data.text=this.component.data.text.slice(0,e)+this.component.data.text.slice(t+7))},this.getMaterialTags=function(){var e=(+Math.floor(this.hasOpacity&&this.material.transparent?255*this.material.opacity:255)).toString(16).toUpperCase();e.length<2&&(e="0"+e);var t='<link id="n-text-material">';return this.hasColor?t+="<color=#"+this.material.color.getHexString()+e+">":this.hasOpacity&&(t+="<alpha=#"+e+">"),t+="</link>"}};